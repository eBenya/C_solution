#include <cstdlib>
#include <iostream>
#define SIZE 100

/*Упражнение 5.1. Функция getint написана так, 
что знаки - или +, за которыми не следует цифра, 
она понимает как "правильное" представление нуля. 
Скорректируйте программу таким образом, чтобы в
подобных случаях она возвращала прочитанный знак 
назад во ввод.*/

int getch(void);
void ungetch(int c);
int getint(int *pn);

int main() {

	setlocale(LC_ALL, "rus");

	int i = 0, type, array[SIZE];

	while ( (type = getint(&array[i])) != EOF ){
		if (type != -50)
			printf("array[%d] = %d\n", i, array[i++]);
		if (i > SIZE) i = 0;
	}

	return 0;
}
/* getint: ?????? ????????? ????? ?? ????? ? *pn */
int getint(int *pn){

	int c, sign;

	while (isspace(c = getch())); /* ??????? ????????-???????????? */

	if (!isdigit(c) && c != EOF && c != '+' && c != '-') {

		return -50;
	}
	sign = (c == '-') ? -1 : 1; //???????? ?????

	if (c == '+' || c == '-')
		if (!isdigit(c = getch()))  return -50;
	for (*pn = 0; isdigit(c); c = getch())
		*pn = 10 * *pn + (c - '0');
	*pn *= sign;
	if (c != EOF)
		ungetch(c);
	return c;
}

#define BUFSIZE 100

char buf[BUFSIZE]; /* ????? ??? ungetch */
int bufp = 0; /* ????, ????????? ??????? ? ?????? */

int getch(void) /* ????? (???????? ????????????) ?????? */
{
	return (bufp > 0) ? buf[--bufp] : getchar();
}
void ungetch(int c) /* ??????? ?????? ?? ???? */
{
	if (bufp >= BUFSIZE)
		printf("ungetch: ??????? ????? ????????\n");
	else
		buf[bufp++] = c;
}
